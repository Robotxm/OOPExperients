# 题目一：基于天数定义并实现日期类型

## 题目原文

Complete and test `Date` of §10.2. 

Reimplement it with "number of days after 1/1/1970" representation.

## 题目翻译

完成并测试 10.2 节的 `Date` 类。

将其内部实现改为“当前日期距离 1970 年 1 月 1 日的天数”并重新实现该类。

## 题目解析

这道题将原有的结构体改写成类这个要求难度不大，我之前在实验二的实现里就采用的这个方式，这里只需要把 `struct` 关键字改成 `class` 关键字即可。至于修改内部实现这个要求，难度也不算太大，最终实现出来类似于单位精确到天的 Unix 时间戳。不过文档里说用 `mktime()` 有点用，我倒没发现有啥用，索性直接忽略了。另外根据教材说明，需要采用枚举来实现月份，这里我增加了一个 `DEFAULT` 表示没有未指定，这样 12 个月就能继续对应了。

这道题比较烦的是，课本上的说明过于零散，确定需要实现的全部接口不太方便。具体接口可以参考 `date.hpp` 头文件里的声明。下面挑几个新增加的接口讲讲，其余的可以去看看代码。

先说我自己加的 `std::tuple<int, Date::Month, int> Date::GetDate() const` 这个，是为了方便处理年月日三个单独的字段设计的，返回值类型是 C++ 新增的元组，相关内容可以自行查阅资料。函数内部实现就是如何将时间戳转换为具体的日期。这里的思路直接照搬实验二里实现的 `AddDays()` 函数，也就是对 1970 年 1 月 1 日累加天数，不清楚的可以去看实验二中的实现。

然后为了方便求时间差，我重载了 `-` 运算符，根据要求返回的是两个日期差的绝对值。用友元重载操作符的好处就是这里可以直接访问到两个 `Date` 对象的 `days_after_origin_` 这个私有成员。然后题目要求的 `Diff()` 函数就可以直接用 `-` 操作符实现。

将日期输出为文本形式采用的是重载类型强制转化 `string()`，这个具体内容在课程中有所涉及，就不多说了。